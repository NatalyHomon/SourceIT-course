<!doctype html>

<html>
<head>
	<title>Раскрывающейся списка</title>
	<meta charset="utf-8">
	<style type="text/css">
	
		ul.expandable li { list-style-image: url('/Task6/img/point.gif') }
		li ul.expandable { display: none } /* выставить в none */
	</style>
	<link rel="stylesheet" href="/Task6/css/form.css">
	<!-- <script src="https://code.jquery.com/jquery-3.6.3.js"></script> -->
	<script type="text/javascript">
		/*
			Опишите функцию setPlusIcon(), которая 
			- устанавливает для элементов li значок [+], 
				если этот элемент имеет вложенный список
			- регистрирует функцию aClick в качестве обработчика события onclick
				для всех ссылок
		*/
		/*
			Запустите функцию setPlusIcon() при загрузке страницы
		*/
		

		window.onload = function setPlusIcon(){

			let uls = document.querySelectorAll('.expandable');
			let aTags = document.querySelectorAll('a');
			const plus = "<img src=\"/Task6/img/plus.gif\">";
			
			
			uls.forEach(function(ul){
				if(ul.parentNode.nodeName = "LI"){
					ul.previousElementSibling.innerHTML+= plus;
					
				}
			})
			
			aTags.forEach(function(a){
				a.addEventListener('click', aClick)
			})

			function aClick(e){
				
				let targetA = e.target;
				let li = targetA.parentNode;
				let ul = targetA.nextElementSibling;
				console.log(li.contains(ul))
				
				if(li.contains(ul)){
					targetA.style.color = 'red';
					ul.style.display = 'block';
					targetA.setAttribute("href", "#");
					let minusIMG = targetA.lastChild.setAttribute("src", "/Task6/img/minus.gif");
					
				}
				if(!li.contains(ul)){
					targetA.setAttribute("href", "https://developer.mozilla.org/en-US/docs/Web/API/Element/toggleAttribute");
					targetA.style.color = 'yellow';
				}
				
			
			}	

		}
			

		/*
			Опишите функцию aClick(), которая обрабатывает щелчок по ссылке
			1. Получите объект - ссылку, по которой был сделан щелчок 
			2. Найдите родительский li
			3. Найдите вложенный список
			4. Если вложенных списков нет - разрешите переход по ссылке
			5. Назначьте вложенному списку нужные свойства и поменяйте иконку
			6. Запретите переход по ссылке
		*/
		
	
	</script>
</head>

<body>
	<h1>Пример раскрывающегося списка</h1>
	<ul class="">
		<li>
			<a href="https://www.w3schools.com/jsref/met_node_haschildnodes.asp">Книги</a>
			<ul class="expandable">
				<li>
					<a  class = "aa" href="https://www.w3schools.com/jsref/met_node_haschildnodes.asp">Отечественные</a>
					<ul class="expandable">
						<li><a href="https://developer.mozilla.org/ru/docs/Web/API/Element/setAttribute">Детективы</a></li>
						<li><a href="https://developer.mozilla.org/ru/docs/Web/API/Element/setAttribute">Научная фантастика</a></li>
						<li><a href="https://developer.mozilla.org/ru/docs/Web/API/Element/setAttribute">Исторические</a></li>
					</ul>
				</li>
				<li>
					<a href="#">Зарубежные</a>
					<ul class="expandable">
						<li><a href="https://developer.mozilla.org/ru/docs/Web/API/Element/setAttribute">Детективы</a></li>
						<li><a href="https://developer.mozilla.org/ru/docs/Web/API/Element/setAttribute">Научная фантастика</a></li>
						<li><a href="#">Исторические</a></li>
					</ul>
				</li>
			</ul>
		</li>
 		<li>
			<a href="#">DVD</a>
			<ul class="expandable">
				<li>
					<a href="#">Отечественные</a>
					<ul class="expandable">
						<li><a href="#">Детективы</a></li>
						<li><a href="#">Научная фантастика</a></li>
						<li><a href="#">Исторические</a></li>
					</ul>
				</li>
				<li>
					<a href="#">Зарубежные</a>
					<ul class="expandable">
						<li><a href="#">Детективы</a></li>
						<li><a href="#">Научная фантастика</a></li>
						<li><a href="#">Исторические</a></li>
					</ul>
				</li>
			</ul>
		</li>
	</ul>
	<img src="" alt="">
</body>
</html>
